app:
  description: Ëá™Âä®ÂåñÂà§ÂÆö
  icon: ü§ñ
  icon_background: '#FFEAD5'
  mode: workflow
  name: 8.0.2Ëá™Âä®ÂåñÂà§ÂÆö
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/tongyi:0.1.3@08f25a10c0617a3512fac091a0f0d894925357e965efe40fdf95cb48e09b62d1
    version: null
kind: app
version: 0.4.0
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: false
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        sourceType: start
        targetType: llm
      id: edge-start-to-llm
      source: start
      sourceHandle: source
      target: llm-auto-scoring
      targetHandle: target
      type: custom
    - data:
        sourceType: llm
        targetType: code
      id: edge-llm-to-json
      source: llm-auto-scoring
      sourceHandle: source
      target: code-json
      targetHandle: target
      type: custom
    - data:
        sourceType: code
        targetType: http-request
      id: edge-json-to-http
      source: code-json
      sourceHandle: source
      target: http-save
      targetHandle: target
      type: custom
    - data:
        sourceType: http-request
        targetType: end
      id: edge-http-to-end
      source: http-save
      sourceHandle: source
      target: end
      targetHandle: target
      type: custom
    nodes:
    - data:
        desc: ËæìÂÖ•‰∫ßÂìÅÂíå‰ºÅ‰∏ö‰ø°ÊÅØ
        selected: false
        title: ÂºÄÂßã
        type: start
        variables:
        - label: ‰∫ßÂìÅÂêç
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: e_product_id_name
        - label: ‰∫ßÂìÅÁÆÄ‰ªã
          max_length: 256
          options: []
          required: true
          type: paragraph
          variable: e_product_id_detail
        - label: ‰∫ßÂìÅÂ∫èÂè∑
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: e_product_id
        - label: ‰ºÅ‰∏öÂêç
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: e_company_name
        - label: ‰ºÅ‰∏öÂπ¥Êî∂ÂÖ•
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: e_company_revenue
        - label: MQLÂà§ÂÆöÊ†áÂáÜÂà∂ÂÆöÁªìÊûú
          max_length: 8192
          options: []
          required: true
          type: paragraph
          variable: mql_criteria_result
        - label: Á∫øÁ¥¢ID
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: lead_id
        - label: Áî®Êà∑id
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: user_id
        - label: ÁßüÊà∑id
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: tenant_id
        - label: ‰ªªÂä°id
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: taskId
      height: 350
      id: start
      position:
        x: 80
        y: 282
      positionAbsolute:
        x: 80
        y: 282
      selected: false
      type: custom
      width: 242
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: Ëá™Âä®ÂåñÁ∫øÁ¥¢ËØÑÂàÜÂíåMQLÂà§ÂÆöÂàÜÊûê
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: qwen3-max
          provider: langgenius/tongyi/tongyi
        prompt_template:
        - id: prompt-system
          role: system
          text: 'ËØ∑‰Ω†‰Ωú‰∏∫‰∏ÄÂêç‰∏ì‰∏öÁöÑËê•ÈîÄËá™Âä®ÂåñÊû∂ÊûÑÂ∏àÔºåÂü∫‰∫éMQLÂà§ÂÆöÊ†áÂáÜÂØπÁ∫øÁ¥¢ËøõË°åËá™Âä®ÂåñËØÑÂàÜÂíåÂà§ÂÆö„ÄÇ


            ËØ∑‰∏•Ê†ºÊåâÁÖßJSON SchemaËæìÂá∫ÂàÜÊûêÁªìÊûúÔºåÂøÖÈ°ªÂåÖÂê´‰ª•‰∏ãÂ≠óÊÆµÔºö

            - leadId: Á∫øÁ¥¢IDÔºàÂ≠óÁ¨¶‰∏≤Á±ªÂûãÔºâ

            - workflowTaskId: Â∑•‰ΩúÊµÅ‰ªªÂä°IDÔºàÂ≠óÁ¨¶‰∏≤Á±ªÂûãÔºâ

            - behaviorScoreDetail: Ë°å‰∏∫ËØÑÂàÜËØ¶ÊÉÖÔºàÂØπË±°Á±ªÂûãÔºâ

            - attributeScoreDetail: Â±ûÊÄßËØÑÂàÜËØ¶ÊÉÖÔºàÂØπË±°Á±ªÂûãÔºâ

            - behaviorScore: Ë°å‰∏∫ËØÑÂàÜÔºàÊï∞Â≠óÁ±ªÂûãÔºâ

            - attributeScore: Â±ûÊÄßËØÑÂàÜÔºàÊï∞Â≠óÁ±ªÂûãÔºâ

            - totalScore: ÊÄªÂàÜÔºàÊï∞Â≠óÁ±ªÂûãÔºâ

            - timeDecayApplied: ÊòØÂê¶Â∫îÁî®Êó∂Èó¥Ë°∞ÂáèÔºàÂ∏ÉÂ∞îÁ±ªÂûãÔºâ

            - repeatDecayApplied: ÊòØÂê¶Â∫îÁî®ÈáçÂ§çË°∞ÂáèÔºàÂ∏ÉÂ∞îÁ±ªÂûãÔºâ

            - decayDetails: Ë°∞ÂáèËØ¶ÊÉÖÔºàÂØπË±°Á±ªÂûãÔºâ

            - thresholdComparison: ÈòàÂÄºÊØîËæÉÔºàÂØπË±°Á±ªÂûãÔºâ

            - isAgentMqlQualified: ÊòØÂê¶Á¨¶ÂêàMQLËµÑÊ†ºÔºàÂ∏ÉÂ∞îÁ±ªÂûãÔºâ

            - isHighPriority: ÊòØÂê¶È´ò‰ºòÂÖàÁ∫ßÔºàÂ∏ÉÂ∞îÁ±ªÂûãÔºâ

            - needsNurturing: ÊòØÂê¶ÈúÄË¶ÅÂüπËÇ≤ÔºàÂ∏ÉÂ∞îÁ±ªÂûãÔºâ

            - agentMqlStatus: MQLÁä∂ÊÄÅÔºàÂ≠óÁ¨¶‰∏≤Á±ªÂûãÔºâ

            - keyTriggers: ÂÖ≥ÈîÆËß¶ÂèëÂõ†Á¥†ÔºàÊï∞ÁªÑÁ±ªÂûãÔºâ

            - recommendedActions: Âª∫ËÆÆË°åÂä®ÔºàÊï∞ÁªÑÁ±ªÂûãÔºâ

            '
        - id: prompt-user
          role: user
          text: '‰ª•‰∏ãÊòØ‰ºÅ‰∏öÂíå‰∫ßÂìÅ‰ø°ÊÅØÔºö

            - ‰∫ßÂìÅÂêçÁß∞Ôºö{{#start.e_product_id_name#}}

            - ‰ºÅ‰∏öÂêçÁß∞Ôºö{{#start.e_company_name#}}

            - ‰ºÅ‰∏öÂπ¥Ëê•Êî∂ËßÑÊ®°Ôºö{{#start.e_company_revenue#}}ÂÖÉ

            - ‰∫ßÂìÅ‰∏ªË¶ÅÂäüËÉΩÔºö{{#start.e_product_id_detail#}}

            - Á∫øÁ¥¢IDÔºö{{#start.lead_id#}}

            - Â∑•‰ΩúÊµÅ‰ªªÂä°IDÔºö{{#start.taskId#}}


            „ÄêMQLÂà§ÂÆöÊ†áÂáÜÂà∂ÂÆöÁªìÊûúÔºàÊù•Ëá™8.0.1Ôºâ„ÄëÔºö

            {{#start.mql_criteria_result#}}


            ËØ∑Âü∫‰∫é‰ª•‰∏äMQLÂà§ÂÆöÊ†áÂáÜÔºåÂØπËØ•Á∫øÁ¥¢ËøõË°åËá™Âä®ÂåñËØÑÂàÜÂíåMQLÂà§ÂÆöÔºåÂπ∂Âú®ËæìÂá∫‰∏≠ÂåÖÂê´Á∫øÁ¥¢IDÂíåÂ∑•‰ΩúÊµÅ‰ªªÂä°ID„ÄÇ

            '
        selected: false
        structured_output:
          schema:
            properties:
              agentMqlStatus:
                description: MQLÁä∂ÊÄÅ
                type: string
              attributeScore:
                description: Â±ûÊÄßËØÑÂàÜ
                type: number
              attributeScoreDetail:
                description: Â±ûÊÄßËØÑÂàÜËØ¶ÊÉÖ
                type: object
              behaviorScore:
                description: Ë°å‰∏∫ËØÑÂàÜ
                type: number
              behaviorScoreDetail:
                description: Ë°å‰∏∫ËØÑÂàÜËØ¶ÊÉÖ
                type: object
              decayDetails:
                description: Ë°∞ÂáèËØ¶ÊÉÖ
                type: object
              isAgentMqlQualified:
                description: ÊòØÂê¶Á¨¶ÂêàMQLËµÑÊ†º
                type: boolean
              isHighPriority:
                description: ÊòØÂê¶È´ò‰ºòÂÖàÁ∫ß
                type: boolean
              keyTriggers:
                description: ÂÖ≥ÈîÆËß¶ÂèëÂõ†Á¥†
                items:
                  type: string
                type: array
              leadId:
                description: Á∫øÁ¥¢ID
                type: string
              needsNurturing:
                description: ÊòØÂê¶ÈúÄË¶ÅÂüπËÇ≤
                type: boolean
              recommendedActions:
                description: Âª∫ËÆÆË°åÂä®
                items:
                  type: string
                type: array
              repeatDecayApplied:
                description: ÊòØÂê¶Â∫îÁî®ÈáçÂ§çË°∞Âáè
                type: boolean
              thresholdComparison:
                description: ÈòàÂÄºÊØîËæÉ
                type: object
              timeDecayApplied:
                description: ÊòØÂê¶Â∫îÁî®Êó∂Èó¥Ë°∞Âáè
                type: boolean
              totalScore:
                description: ÊÄªÂàÜ
                type: number
              workflowTaskId:
                description: Â∑•‰ΩúÊµÅ‰ªªÂä°ID
                type: string
            required:
            - leadId
            - workflowTaskId
            - behaviorScoreDetail
            - attributeScoreDetail
            - behaviorScore
            - attributeScore
            - totalScore
            - timeDecayApplied
            - repeatDecayApplied
            - decayDetails
            - thresholdComparison
            - isAgentMqlQualified
            - isHighPriority
            - needsNurturing
            - agentMqlStatus
            - keyTriggers
            - recommendedActions
            type: object
        structured_output_enabled: true
        title: Ëá™Âä®ÂåñÂà§ÂÆö
        type: llm
        variables: []
        vision:
          enabled: false
      height: 116
      id: llm-auto-scoring
      position:
        x: 384
        y: 282
      positionAbsolute:
        x: 384
        y: 282
      selected: false
      type: custom
      width: 242
    - data:
        code: "import json\ndef main(behaviorScoreDetail: dict, attributeScoreDetail:\
          \ dict, decayDetails: dict, thresholdComparison: dict, keyTriggers: list,\
          \ recommendedActions: list) -> dict:\n    result = {}\n    try:\n      \
          \  result[\"behaviorScoreDetail\"] = json.dumps(behaviorScoreDetail, ensure_ascii=False,\
          \ separators=(',', ':'))\n        result[\"attributeScoreDetail\"] = json.dumps(attributeScoreDetail,\
          \ ensure_ascii=False, separators=(',', ':'))\n        result[\"decayDetails\"\
          ] = json.dumps(decayDetails, ensure_ascii=False, separators=(',', ':'))\n\
          \        result[\"thresholdComparison\"] = json.dumps(thresholdComparison,\
          \ ensure_ascii=False, separators=(',', ':'))\n        result[\"keyTriggers\"\
          ] = json.dumps(keyTriggers, ensure_ascii=False, separators=(',', ':'))\n\
          \        result[\"recommendedActions\"] = json.dumps(recommendedActions,\
          \ ensure_ascii=False, separators=(',', ':'))\n    except Exception as e:\n\
          \        pass\n    return result\n"
        code_language: python3
        desc: Â∞ÜÂ§çÊùÇÂ≠óÊÆµËΩ¨‰∏∫JSONÂ≠óÁ¨¶‰∏≤
        outputs:
          attributeScoreDetail:
            children: null
            type: string
          behaviorScoreDetail:
            children: null
            type: string
          decayDetails:
            children: null
            type: string
          keyTriggers:
            children: null
            type: string
          recommendedActions:
            children: null
            type: string
          thresholdComparison:
            children: null
            type: string
        selected: false
        title: ËΩ¨JSON
        type: code
        variables:
        - value_selector:
          - llm-auto-scoring
          - structured_output
          - behaviorScoreDetail
          value_type: object
          variable: behaviorScoreDetail
        - value_selector:
          - llm-auto-scoring
          - structured_output
          - attributeScoreDetail
          value_type: object
          variable: attributeScoreDetail
        - value_selector:
          - llm-auto-scoring
          - structured_output
          - decayDetails
          value_type: object
          variable: decayDetails
        - value_selector:
          - llm-auto-scoring
          - structured_output
          - thresholdComparison
          value_type: object
          variable: thresholdComparison
        - value_selector:
          - llm-auto-scoring
          - structured_output
          - keyTriggers
          value_type: array[string]
          variable: keyTriggers
        - value_selector:
          - llm-auto-scoring
          - structured_output
          - recommendedActions
          value_type: array[string]
          variable: recommendedActions
      height: 80
      id: code-json
      position:
        x: 688
        y: 282
      positionAbsolute:
        x: 688
        y: 282
      selected: false
      type: custom
      width: 242
    - data:
        authorization:
          type: no-auth
        body:
          data:
          - id: key-value-1
            key: ''
            type: text
            value: "{\n  \"leadId\":\"{{#start.lead_id#}}\",\n  \"workflowTaskId\"\
              :\"{{#start.taskId#}}\",\n  \"behaviorScoreDetail\":{{#code-json.behaviorScoreDetail#}},\n\
              \  \"attributeScoreDetail\":{{#code-json.attributeScoreDetail#}},\n\
              \  \"behaviorScore\":{{#llm-auto-scoring.structured_output.behaviorScore#}},\n\
              \  \"attributeScore\":{{#llm-auto-scoring.structured_output.attributeScore#}},\n\
              \  \"totalScore\":{{#llm-auto-scoring.structured_output.totalScore#}},\n\
              \  \"timeDecayApplied\":{{#llm-auto-scoring.structured_output.timeDecayApplied#}},\n\
              \  \"repeatDecayApplied\":{{#llm-auto-scoring.structured_output.repeatDecayApplied#}},\n\
              \  \"decayDetails\":{{#code-json.decayDetails#}},\n  \"thresholdComparison\"\
              :{{#code-json.thresholdComparison#}},\n  \"isAgentMqlQualified\":{{#llm-auto-scoring.structured_output.isAgentMqlQualified#}},\n\
              \  \"isHighPriority\":{{#llm-auto-scoring.structured_output.isHighPriority#}},\n\
              \  \"needsNurturing\":{{#llm-auto-scoring.structured_output.needsNurturing#}},\n\
              \  \"agentMqlStatus\":\"{{#llm-auto-scoring.structured_output.agentMqlStatus#}}\"\
              ,\n  \"keyTriggers\":{{#code-json.keyTriggers#}},\n  \"recommendedActions\"\
              :{{#code-json.recommendedActions#}}\n}"
          type: json
        dependencies:
        - code-json
        desc: ‰øùÂ≠òËá™Âä®ÂåñÂà§ÂÆöÁªìÊûúÂà∞ÂêéÁ´Ø
        headers: 'Authorization:test{{#start.user_id#}}


          tenant-id:{{#start.tenant_id#}}'
        method: post
        params: ''
        retry_config:
          max_retries: 3
          retry_enabled: true
          retry_interval: 100
        selected: false
        timeout:
          connect: 10
          read: 60
          write: 60
        title: ‰øùÂ≠òÂà∞ÂêéÁ´Ø
        type: http-request
        url: https://agent.cstlanbaai.com/gateway/admin-api/scrm/mql-auto-scoring/create
      height: 182
      id: http-save
      position:
        x: 992
        y: 282
      positionAbsolute:
        x: 992
        y: 282
      selected: false
      type: custom
      width: 242
    - data:
        desc: ËæìÂá∫ÁªìÊûú
        outputs:
        - value_selector:
          - llm-auto-scoring
          - structured_output
          - output
          variable: auto_scoring_result
        selected: false
        title: ÁªìÊùü
        type: end
      height: 116
      id: end
      position:
        x: 1296
        y: 282
      positionAbsolute:
        x: 1296
        y: 282
      selected: false
      type: custom
      width: 242
    viewport:
      x: 0
      y: 0
      zoom: 1
  rag_pipeline_variables: []
