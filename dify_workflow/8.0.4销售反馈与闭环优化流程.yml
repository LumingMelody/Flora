app:
  description: ÈîÄÂîÆÂèçÈ¶à‰∏éÈó≠ÁéØ‰ºòÂåñÊµÅÁ®ã
  icon: ü§ñ
  icon_background: '#FFEAD5'
  mode: workflow
  name: 8.0.4ÈîÄÂîÆÂèçÈ¶à‰∏éÈó≠ÁéØ‰ºòÂåñÊµÅÁ®ã
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/tongyi:0.1.3@08f25a10c0617a3512fac091a0f0d894925357e965efe40fdf95cb48e09b62d1
    version: null
kind: app
version: 0.4.0
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: false
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        sourceType: start
        targetType: llm
      id: edge-start-to-llm
      source: start
      sourceHandle: source
      target: llm-sales-feedback
      targetHandle: target
      type: custom
    - data:
        sourceType: llm
        targetType: code
      id: edge-llm-to-json
      source: llm-sales-feedback
      sourceHandle: source
      target: code-json
      targetHandle: target
      type: custom
    - data:
        sourceType: code
        targetType: http-request
      id: edge-json-to-http
      source: code-json
      sourceHandle: source
      target: http-save
      targetHandle: target
      type: custom
    - data:
        sourceType: http-request
        targetType: end
      id: edge-http-to-end
      source: http-save
      sourceHandle: source
      target: end
      targetHandle: target
      type: custom
    nodes:
    - data:
        desc: ËæìÂÖ•‰∫ßÂìÅÂíå‰ºÅ‰∏ö‰ø°ÊÅØ
        selected: false
        title: ÂºÄÂßã
        type: start
        variables:
        - label: ‰∫ßÂìÅÂêç
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: e_product_id_name
        - label: ‰∫ßÂìÅÁÆÄ‰ªã
          max_length: 256
          options: []
          required: true
          type: paragraph
          variable: e_product_id_detail
        - label: ‰∫ßÂìÅÂ∫èÂè∑
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: e_product_id
        - label: ‰ºÅ‰∏öÂêç
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: e_company_name
        - label: ‰ºÅ‰∏öÂπ¥Êî∂ÂÖ•
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: e_company_revenue
        - label: MQLÊµÅËΩ¨ÂàÜÈÖçÁªìÊûú
          max_length: 8192
          options: []
          required: true
          type: paragraph
          variable: mql_routing_result
        - label: Áî®Êà∑id
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: user_id
        - label: ÁßüÊà∑id
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: tenant_id
        - label: ‰ªªÂä°id
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: taskId
      height: 324
      id: start
      position:
        x: 80
        y: 282
      positionAbsolute:
        x: 80
        y: 282
      selected: false
      type: custom
      width: 242
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ÈîÄÂîÆÂèçÈ¶àÊî∂ÈõÜÂíåMQLÊµÅÁ®ã‰ºòÂåñÂàÜÊûê
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: qwen3-max
          provider: langgenius/tongyi/tongyi
        prompt_template:
        - id: prompt-system
          role: system
          text: 'ËØ∑‰Ω†‰Ωú‰∏∫‰∏ÄÂêç‰∏ì‰∏öÁöÑÈîÄÂîÆËøêËê•ÂíåÊµÅÁ®ã‰ºòÂåñ‰∏ìÂÆ∂ÔºåÊàë‰ºöÂêë‰Ω†Êèê‰æõ‰ºÅ‰∏öÁöÑ‰∫ßÂìÅÂíå‰∏öÂä°‰ø°ÊÅØ„ÄÇËØ∑‰Ω†‰∏∫ËØ•‰ºÅ‰∏öËÆæËÆ°ÈîÄÂîÆÂèçÈ¶àÊî∂ÈõÜÂíåMQLÊµÅÁ®ã‰ºòÂåñÁöÑÈó≠ÁéØ‰ΩìÁ≥ªÔºåÁ°Æ‰øùËê•ÈîÄÂíåÈîÄÂîÆÂõ¢ÈòüËÉΩÂ§üÊåÅÁª≠ÊîπËøõÁ∫øÁ¥¢Ë¥®Èáè„ÄÇ


            ËØ∑‰∏•Ê†ºÊåâÁÖßJSON SchemaËæìÂá∫ÂàÜÊûêÁªìÊûúÔºåÂøÖÈ°ªÂåÖÂê´‰ª•‰∏ãÂ≠óÊÆµÔºö

            - productId: ‰∫ßÂìÅIDÔºàÂ≠óÁ¨¶‰∏≤Á±ªÂûãÔºâ

            - workflowTaskId: Â∑•‰ΩúÊµÅ‰ªªÂä°IDÔºàÂ≠óÁ¨¶‰∏≤Á±ªÂûãÔºâ

            - feedbackPeriodStart: ÂèçÈ¶àÂë®ÊúüÂºÄÂßãÊó•ÊúüÔºàÂ≠óÁ¨¶‰∏≤Á±ªÂûãÔºâ

            - feedbackPeriodEnd: ÂèçÈ¶àÂë®ÊúüÁªìÊùüÊó•ÊúüÔºàÂ≠óÁ¨¶‰∏≤Á±ªÂûãÔºâ

            - totalLeadsAnalyzed: ÂàÜÊûêÁöÑÁ∫øÁ¥¢ÊÄªÊï∞ÔºàÊï∞Â≠óÁ±ªÂûãÔºâ

            - qualifiedLeadsCount: ÂêàÊ†ºÁ∫øÁ¥¢Êï∞ÈáèÔºàÊï∞Â≠óÁ±ªÂûãÔºâ

            - unqualifiedLeadsCount: ‰∏çÂêàÊ†ºÁ∫øÁ¥¢Êï∞ÈáèÔºàÊï∞Â≠óÁ±ªÂûãÔºâ

            - agentMqlToSqlRate: MQLÂà∞SQLËΩ¨ÂåñÁéáÔºàÊï∞Â≠óÁ±ªÂûãÔºâ

            - sourceQualityAnalysis: Êù•Ê∫êË¥®ÈáèÂàÜÊûêÔºàÂØπË±°Á±ªÂûãÔºâ

            - scoreConversionAnalysis: ËØÑÂàÜËΩ¨ÂåñÂàÜÊûêÔºàÂØπË±°Á±ªÂûãÔºâ

            - responseTimeAnalysis: ÂìçÂ∫îÊó∂Èó¥ÂàÜÊûêÔºàÂØπË±°Á±ªÂûãÔºâ

            - seasonalTrendAnalysis: Â≠£ËäÇÊÄßË∂ãÂäøÂàÜÊûêÔºàÂØπË±°Á±ªÂûãÔºâ

            - disqualificationReasons: ‰∏çÂêàÊ†ºÂéüÂõ†ÔºàÂØπË±°Á±ªÂûãÔºâ

            - topRejectionReasons: ‰∏ªË¶ÅÊãíÁªùÂéüÂõ†ÔºàÊï∞ÁªÑÁ±ªÂûãÔºâ

            - scoreWeightSuggestions: ËØÑÂàÜÊùÉÈáçÂª∫ËÆÆÔºàÂØπË±°Á±ªÂûãÔºâ

            - thresholdSuggestions: ÈòàÂÄºÂª∫ËÆÆÔºàÂØπË±°Á±ªÂûãÔºâ

            - ruleOptimizationSuggestions: ËßÑÂàô‰ºòÂåñÂª∫ËÆÆÔºàÊï∞ÁªÑÁ±ªÂûãÔºâ

            - routingOptimizationSuggestions: ÊµÅËΩ¨‰ºòÂåñÂª∫ËÆÆÔºàÊï∞ÁªÑÁ±ªÂûãÔºâ

            - nurturingStrategySuggestions: ÂüπËÇ≤Á≠ñÁï•Âª∫ËÆÆÔºàÊï∞ÁªÑÁ±ªÂûãÔºâ

            '
        - id: prompt-user
          role: user
          text: '‰ª•‰∏ãÊòØ‰ºÅ‰∏öÂíå‰∫ßÂìÅ‰ø°ÊÅØÔºö

            - ‰∫ßÂìÅÂêçÁß∞Ôºö{{#start.e_product_id_name#}}

            - ‰ºÅ‰∏öÂêçÁß∞Ôºö{{#start.e_company_name#}}

            - ‰ºÅ‰∏öÂπ¥Ëê•Êî∂ËßÑÊ®°Ôºö{{#start.e_company_revenue#}}ÂÖÉ

            - ‰∫ßÂìÅ‰∏ªË¶ÅÂäüËÉΩÔºö{{#start.e_product_id_detail#}}

            - ‰∫ßÂìÅIDÔºö{{#start.e_product_id#}}

            - Â∑•‰ΩúÊµÅ‰ªªÂä°IDÔºö{{#start.taskId#}}


            „ÄêMQLÊµÅËΩ¨ÂàÜÈÖçÁªìÊûúÔºàÊù•Ëá™8.0.3Ôºâ„ÄëÔºö

            {{#start.mql_routing_result#}}


            ËØ∑Âü∫‰∫é‰ª•‰∏äMQLÊµÅËΩ¨ÂàÜÈÖçÁªìÊûúÔºåÂàÜÊûêÈîÄÂîÆÂèçÈ¶àÂπ∂ÁªôÂá∫MQLÊµÅÁ®ã‰ºòÂåñÂª∫ËÆÆÔºåÂπ∂Âú®ËæìÂá∫‰∏≠ÂåÖÂê´‰∫ßÂìÅIDÂíåÂ∑•‰ΩúÊµÅ‰ªªÂä°ID„ÄÇ

            '
        selected: false
        structured_output:
          schema:
            properties:
              agentMqlToSqlRate:
                description: MQLÂà∞SQLËΩ¨ÂåñÁéá
                type: number
              disqualificationReasons:
                description: ‰∏çÂêàÊ†ºÂéüÂõ†
                type: object
              feedbackPeriodEnd:
                description: ÂèçÈ¶àÂë®ÊúüÁªìÊùüÊó•Êúü
                type: string
              feedbackPeriodStart:
                description: ÂèçÈ¶àÂë®ÊúüÂºÄÂßãÊó•Êúü
                type: string
              nurturingStrategySuggestions:
                description: ÂüπËÇ≤Á≠ñÁï•Âª∫ËÆÆ
                items:
                  type: string
                type: array
              productId:
                description: ‰∫ßÂìÅID
                type: string
              qualifiedLeadsCount:
                description: ÂêàÊ†ºÁ∫øÁ¥¢Êï∞Èáè
                type: number
              responseTimeAnalysis:
                description: ÂìçÂ∫îÊó∂Èó¥ÂàÜÊûê
                type: object
              routingOptimizationSuggestions:
                description: ÊµÅËΩ¨‰ºòÂåñÂª∫ËÆÆ
                items:
                  type: string
                type: array
              ruleOptimizationSuggestions:
                description: ËßÑÂàô‰ºòÂåñÂª∫ËÆÆ
                items:
                  type: string
                type: array
              scoreConversionAnalysis:
                description: ËØÑÂàÜËΩ¨ÂåñÂàÜÊûê
                type: object
              scoreWeightSuggestions:
                description: ËØÑÂàÜÊùÉÈáçÂª∫ËÆÆ
                type: object
              seasonalTrendAnalysis:
                description: Â≠£ËäÇÊÄßË∂ãÂäøÂàÜÊûê
                type: object
              sourceQualityAnalysis:
                description: Êù•Ê∫êË¥®ÈáèÂàÜÊûê
                type: object
              thresholdSuggestions:
                description: ÈòàÂÄºÂª∫ËÆÆ
                type: object
              topRejectionReasons:
                description: ‰∏ªË¶ÅÊãíÁªùÂéüÂõ†
                items:
                  type: string
                type: array
              totalLeadsAnalyzed:
                description: ÂàÜÊûêÁöÑÁ∫øÁ¥¢ÊÄªÊï∞
                type: number
              unqualifiedLeadsCount:
                description: ‰∏çÂêàÊ†ºÁ∫øÁ¥¢Êï∞Èáè
                type: number
              workflowTaskId:
                description: Â∑•‰ΩúÊµÅ‰ªªÂä°ID
                type: string
            required:
            - productId
            - workflowTaskId
            - feedbackPeriodStart
            - feedbackPeriodEnd
            - totalLeadsAnalyzed
            - qualifiedLeadsCount
            - unqualifiedLeadsCount
            - agentMqlToSqlRate
            - sourceQualityAnalysis
            - scoreConversionAnalysis
            - responseTimeAnalysis
            - seasonalTrendAnalysis
            - disqualificationReasons
            - topRejectionReasons
            - scoreWeightSuggestions
            - thresholdSuggestions
            - ruleOptimizationSuggestions
            - routingOptimizationSuggestions
            - nurturingStrategySuggestions
            type: object
        structured_output_enabled: true
        title: ÈîÄÂîÆÂèçÈ¶à‰∏é‰ºòÂåñ
        type: llm
        variables: []
        vision:
          enabled: false
      height: 116
      id: llm-sales-feedback
      position:
        x: 384
        y: 282
      positionAbsolute:
        x: 384
        y: 282
      selected: false
      type: custom
      width: 242
    - data:
        code: "import json\ndef main(sourceQualityAnalysis: dict, scoreConversionAnalysis:\
          \ dict, responseTimeAnalysis: dict, seasonalTrendAnalysis: dict, disqualificationReasons:\
          \ dict, topRejectionReasons: list, scoreWeightSuggestions: dict, thresholdSuggestions:\
          \ dict, ruleOptimizationSuggestions: list, routingOptimizationSuggestions:\
          \ list, nurturingStrategySuggestions: list) -> dict:\n    result = {}\n\
          \    try:\n        result[\"sourceQualityAnalysis\"] = json.dumps(sourceQualityAnalysis,\
          \ ensure_ascii=False, separators=(',', ':'))\n        result[\"scoreConversionAnalysis\"\
          ] = json.dumps(scoreConversionAnalysis, ensure_ascii=False, separators=(',',\
          \ ':'))\n        result[\"responseTimeAnalysis\"] = json.dumps(responseTimeAnalysis,\
          \ ensure_ascii=False, separators=(',', ':'))\n        result[\"seasonalTrendAnalysis\"\
          ] = json.dumps(seasonalTrendAnalysis, ensure_ascii=False, separators=(',',\
          \ ':'))\n        result[\"disqualificationReasons\"] = json.dumps(disqualificationReasons,\
          \ ensure_ascii=False, separators=(',', ':'))\n        result[\"topRejectionReasons\"\
          ] = json.dumps(topRejectionReasons, ensure_ascii=False, separators=(',',\
          \ ':'))\n        result[\"scoreWeightSuggestions\"] = json.dumps(scoreWeightSuggestions,\
          \ ensure_ascii=False, separators=(',', ':'))\n        result[\"thresholdSuggestions\"\
          ] = json.dumps(thresholdSuggestions, ensure_ascii=False, separators=(',',\
          \ ':'))\n        result[\"ruleOptimizationSuggestions\"] = json.dumps(ruleOptimizationSuggestions,\
          \ ensure_ascii=False, separators=(',', ':'))\n        result[\"routingOptimizationSuggestions\"\
          ] = json.dumps(routingOptimizationSuggestions, ensure_ascii=False, separators=(',',\
          \ ':'))\n        result[\"nurturingStrategySuggestions\"] = json.dumps(nurturingStrategySuggestions,\
          \ ensure_ascii=False, separators=(',', ':'))\n    except Exception as e:\n\
          \        pass\n    return result\n"
        code_language: python3
        desc: Â∞ÜÂ§çÊùÇÂ≠óÊÆµËΩ¨‰∏∫JSONÂ≠óÁ¨¶‰∏≤
        outputs:
          disqualificationReasons:
            children: null
            type: string
          nurturingStrategySuggestions:
            children: null
            type: string
          responseTimeAnalysis:
            children: null
            type: string
          routingOptimizationSuggestions:
            children: null
            type: string
          ruleOptimizationSuggestions:
            children: null
            type: string
          scoreConversionAnalysis:
            children: null
            type: string
          scoreWeightSuggestions:
            children: null
            type: string
          seasonalTrendAnalysis:
            children: null
            type: string
          sourceQualityAnalysis:
            children: null
            type: string
          thresholdSuggestions:
            children: null
            type: string
          topRejectionReasons:
            children: null
            type: string
        selected: false
        title: ËΩ¨JSON
        type: code
        variables:
        - value_selector:
          - llm-sales-feedback
          - structured_output
          - sourceQualityAnalysis
          value_type: object
          variable: sourceQualityAnalysis
        - value_selector:
          - llm-sales-feedback
          - structured_output
          - scoreConversionAnalysis
          value_type: object
          variable: scoreConversionAnalysis
        - value_selector:
          - llm-sales-feedback
          - structured_output
          - responseTimeAnalysis
          value_type: object
          variable: responseTimeAnalysis
        - value_selector:
          - llm-sales-feedback
          - structured_output
          - seasonalTrendAnalysis
          value_type: object
          variable: seasonalTrendAnalysis
        - value_selector:
          - llm-sales-feedback
          - structured_output
          - disqualificationReasons
          value_type: object
          variable: disqualificationReasons
        - value_selector:
          - llm-sales-feedback
          - structured_output
          - topRejectionReasons
          value_type: array[string]
          variable: topRejectionReasons
        - value_selector:
          - llm-sales-feedback
          - structured_output
          - scoreWeightSuggestions
          value_type: object
          variable: scoreWeightSuggestions
        - value_selector:
          - llm-sales-feedback
          - structured_output
          - thresholdSuggestions
          value_type: object
          variable: thresholdSuggestions
        - value_selector:
          - llm-sales-feedback
          - structured_output
          - ruleOptimizationSuggestions
          value_type: array[string]
          variable: ruleOptimizationSuggestions
        - value_selector:
          - llm-sales-feedback
          - structured_output
          - routingOptimizationSuggestions
          value_type: array[string]
          variable: routingOptimizationSuggestions
        - value_selector:
          - llm-sales-feedback
          - structured_output
          - nurturingStrategySuggestions
          value_type: array[string]
          variable: nurturingStrategySuggestions
      height: 80
      id: code-json
      position:
        x: 688
        y: 282
      positionAbsolute:
        x: 688
        y: 282
      selected: false
      type: custom
      width: 242
    - data:
        authorization:
          type: no-auth
        body:
          data:
          - id: key-value-1
            key: ''
            type: text
            value: "{\n  \"productId\":\"{{#start.e_product_id#}}\",\n  \"workflowTaskId\"\
              :\"{{#start.taskId#}}\",\n  \"feedbackPeriodStart\":\"{{#llm-sales-feedback.structured_output.feedbackPeriodStart#}}\"\
              ,\n  \"feedbackPeriodEnd\":\"{{#llm-sales-feedback.structured_output.feedbackPeriodEnd#}}\"\
              ,\n  \"totalLeadsAnalyzed\":{{#llm-sales-feedback.structured_output.totalLeadsAnalyzed#}},\n\
              \  \"qualifiedLeadsCount\":{{#llm-sales-feedback.structured_output.qualifiedLeadsCount#}},\n\
              \  \"unqualifiedLeadsCount\":{{#llm-sales-feedback.structured_output.unqualifiedLeadsCount#}},\n\
              \  \"agentMqlToSqlRate\":{{#llm-sales-feedback.structured_output.agentMqlToSqlRate#}},\n\
              \  \"sourceQualityAnalysis\":{{#code-json.sourceQualityAnalysis#}},\n\
              \  \"scoreConversionAnalysis\":{{#code-json.scoreConversionAnalysis#}},\n\
              \  \"responseTimeAnalysis\":{{#code-json.responseTimeAnalysis#}},\n\
              \  \"seasonalTrendAnalysis\":{{#code-json.seasonalTrendAnalysis#}},\n\
              \  \"disqualificationReasons\":{{#code-json.disqualificationReasons#}},\n\
              \  \"topRejectionReasons\":{{#code-json.topRejectionReasons#}},\n  \"\
              scoreWeightSuggestions\":{{#code-json.scoreWeightSuggestions#}},\n \
              \ \"thresholdSuggestions\":{{#code-json.thresholdSuggestions#}},\n \
              \ \"ruleOptimizationSuggestions\":{{#code-json.ruleOptimizationSuggestions#}},\n\
              \  \"routingOptimizationSuggestions\":{{#code-json.routingOptimizationSuggestions#}},\n\
              \  \"nurturingStrategySuggestions\":{{#code-json.nurturingStrategySuggestions#}}\n\
              }"
          type: json
        dependencies:
        - code-json
        desc: ‰øùÂ≠òÈîÄÂîÆÂèçÈ¶àÁªìÊûúÂà∞Êï∞ÊçÆÂ∫ì
        headers: 'Authorization:test{{#start.user_id#}}


          tenant-id:{{#start.tenant_id#}}'
        method: post
        params: ''
        retry_config:
          max_retries: 3
          retry_enabled: true
          retry_interval: 100
        selected: false
        timeout:
          connect: 10
          read: 60
          write: 60
        title: ‰øùÂ≠òÈîÄÂîÆÂèçÈ¶àÁªìÊûú
        type: http-request
        url: https://agent.cstlanbaai.com/gateway/admin-api/scrm/mql-feedback-optimization/create
      height: 198
      id: http-save
      position:
        x: 992
        y: 282
      positionAbsolute:
        x: 992
        y: 282
      selected: false
      type: custom
      width: 242
    - data:
        desc: ËæìÂá∫ÁªìÊûú
        outputs:
        - value_selector:
          - llm-sales-feedback
          - structured_output
          - output
          variable: sales_feedback_result
        selected: false
        title: ÁªìÊùü
        type: end
      height: 116
      id: end
      position:
        x: 1296
        y: 282
      positionAbsolute:
        x: 1296
        y: 282
      selected: false
      type: custom
      width: 242
    viewport:
      x: 0
      y: 0
      zoom: 1
  rag_pipeline_variables: []
